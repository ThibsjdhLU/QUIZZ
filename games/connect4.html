<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Puissance 4</title>
    <meta name="description" content="Puissance 4 √† deux joueurs" />
    <meta name="google-adsense-account" content="ca-pub-6741696677775096" />
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6741696677775096" crossorigin="anonymous"></script>
    <link rel="icon" href="../assets/favicon.svg">
    <link rel="stylesheet" href="../assets/site.css">
    <style>
      :root { color-scheme: light dark; }
      * { box-sizing: border-box; }
      body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji', sans-serif; }
      header { display: flex; justify-content: space-between; align-items: center; padding: 1rem; border-bottom: 1px solid currentColor; }
      header a { text-decoration: none; color: inherit; }
      main { max-width: 720px; margin: 0 auto; padding: 1.25rem 1rem 3rem; }
      h1 { margin: 0; font-size: clamp(22px, 4vw, 32px); }
      .bar { display: flex; gap: 12px; align-items: center; flex-wrap: wrap; margin-top: 0.5rem; }
      .badge { padding: 0.35rem 0.6rem; border: 1px solid currentColor; border-radius: 999px; }
      .board { display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px; margin-top: 1rem; }
      .cell { width: 70px; height: 70px; border-radius: 50%; background: color-mix(in oklab, currentColor 10%, transparent); display: grid; place-items: center; cursor: pointer; }
      .token { width: 60px; height: 60px; border-radius: 50%; }
      .r { background: crimson; }
      .y { background: gold; }
      .row { display: contents; }
      button { font: inherit; padding: 0.5rem 0.9rem; border: 1px solid currentColor; background: transparent; border-radius: 10px; cursor: pointer; }
    </style>
  </head>
  <body>
    <header class="site">
      <div class="left"><a class="btn ghost" href="../index.html">‚Üê Accueil</a></div>
      <h1>üü°üî¥ Puissance¬†4</h1>
      <div class="right"><button id="theme-toggle" class="theme-toggle" aria-label="Changer de th√®me">üåô</button></div>
    </header>
    <main class="container">
      <div class="ad-wrap" aria-label="Publicit√©">
        <small class="ad-label">Publicit√©</small>
        <ins class="adsbygoogle" style="display:block"
             data-ad-client="ca-pub-6741696677775096"
             data-ad-slot="4777820316"
             data-ad-format="auto" data-full-width-responsive="true"></ins>
      </div>
      <div class="bar">
        <div class="badge">Tour: <span id="turn">Rouge</span></div>
        <button id="reset">Rejouer</button>
      </div>
      <div id="board" class="board" aria-label="Grille Puissance 4"></div>
      <div class="ad-wrap" aria-label="Publicit√©">
        <small class="ad-label">Publicit√©</small>
        <ins class="adsbygoogle" style="display:block"
             data-ad-client="ca-pub-6741696677775096"
             data-ad-slot="3464738647"
             data-ad-format="auto" data-full-width-responsive="true"></ins>
      </div>
    </main>
    <script defer src="../assets/config.js"></script>
    <script defer src="../assets/site.js"></script>
    <script>
      (function(){
        const W=7,H=6; // colonnes, lignes
        const boardEl = document.getElementById('board');
        const turnEl = document.getElementById('turn');
        const resetBtn = document.getElementById('reset');
        let grid, turn; // 'r' ou 'y'

        function init(){ grid = Array.from({length:H}, ()=>Array(W).fill(null)); turn='r'; turnEl.textContent='Rouge'; render(); }

        function render(){
          boardEl.innerHTML='';
          for(let y=0;y<H;y++){
            for(let x=0;x<W;x++){
              const d=document.createElement('div'); d.className='cell'; d.dataset.x=x; d.addEventListener('click', ()=>drop(x));
              const v=grid[y][x]; if(v){ const t=document.createElement('div'); t.className='token '+v; d.appendChild(t); }
              boardEl.appendChild(d);
            }
          }
        }

        function drop(x){
          for(let y=H-1;y>=0;y--){ if(!grid[y][x]){ grid[y][x]=turn; render(); const w=winner(); if(w){ setTimeout(()=>alert((w==='r'?'Rouge':'Jaune')+' gagne !'), 10); } else if(full()) { setTimeout(()=>alert('√âgalit√©.'),10); } else { turn = (turn==='r'?'y':'r'); turnEl.textContent = (turn==='r'?'Rouge':'Jaune'); } return; } }
        }

        function full(){ return grid.every(row=>row.every(Boolean)); }
        function winner(){
          const lines = [];
          for(let y=0;y<H;y++) for(let x=0;x<W-3;x++) lines.push([[y,x],[y,x+1],[y,x+2],[y,x+3]]);
          for(let y=0;y<H-3;y++) for(let x=0;x<W;x++) lines.push([[y,x],[y+1,x],[y+2,x],[y+3,x]]);
          for(let y=0;y<H-3;y++) for(let x=0;x<W-3;x++) lines.push([[y,x],[y+1,x+1],[y+2,x+2],[y+3,x+3]]);
          for(let y=3;y<H;y++) for(let x=0;x<W-3;x++) lines.push([[y,x],[y-1,x+1],[y-2,x+2],[y-3,x+3]]);
          for(const line of lines){ const [a,b,c,d]=line; const v=grid[a[0]][a[1]]; if(v && v===grid[b[0]][b[1]] && v===grid[c[0]][c[1]] && v===grid[d[0]][d[1]]) return v; }
          return null;
        }

        resetBtn.addEventListener('click', init);
        init();
      })();
    </script>
  </body>
  
</html>
